<script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js" type="text/javascript"></script>

<script type = "text/javascript" language ="javascript">
var mqtt;
var reconnectTimeout = 2000;
var host ="broker.hivemq.com";
var port=8000;

function onConnect() {
    console.log("Connected");
    mqtt.subscribe("/gti780a2021alerts/equipe09/alert")
}

function onMessageArrived(msg){
    console.log(msg.payloadString.replaceAll(';',','));
}

function MQTTconnect(){
    console.log("connection to " + host +" " + port);
    mqtt = new Paho.MQTT.Client(host,port,"clientjs")
    var options = {
        timeout: 3,
        onSuccess: onConnect,
    };
    mqtt.onMessageArrived = onMessageArrived
    mqtt.connect(options);
}
</script>

<h1>Labo2</h1>
<script>
    MQTTconnect();
</script>
